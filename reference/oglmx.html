<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Ordered Generalized Linear Model. — oglmx • oglm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit Ordered Generalized Linear Model. — oglmx" />
<meta property="og:description" content="oglmx is used to estimate models for which
the outcome variable is discrete and the mean and/or
variance of the underlying latent variable can be
modelled as a linear combination of explanatory variables.
Standard models such as probit, logit, ordered probit
and ordered logit are included in the diverse
set of models estimated by the function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oglm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Ordered Generalized Linear Model.</h1>
    
    <div class="hidden name"><code>oglmx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>oglmx is used to estimate models for which
the outcome variable is discrete and the mean and/or
variance of the underlying latent variable can be
modelled as a linear combination of explanatory variables.
Standard models such as probit, logit, ordered probit
and ordered logit are included in the diverse
set of models estimated by the function.</p>
    </div>

    <pre class="usage"><span class='fu'>oglmx</span><span class='op'>(</span>
  <span class='va'>formulaMEAN</span>,
  formulaSD <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>data</span>,
  start <span class='op'>=</span> <span class='cn'>NULL</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  link <span class='op'>=</span> <span class='st'>"probit"</span>,
  constantMEAN <span class='op'>=</span> <span class='cn'>TRUE</span>,
  constantSD <span class='op'>=</span> <span class='cn'>TRUE</span>,
  beta <span class='op'>=</span> <span class='cn'>NULL</span>,
  delta <span class='op'>=</span> <span class='cn'>NULL</span>,
  threshparam <span class='op'>=</span> <span class='cn'>NULL</span>,
  analhessian <span class='op'>=</span> <span class='cn'>TRUE</span>,
  sdmodel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>)</span><span class='op'>)</span>,
  optmeth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NR"</span>, <span class='st'>"BFGS"</span>, <span class='st'>"BFGSR"</span>, <span class='st'>"BHHH"</span>, <span class='st'>"SANN"</span>, <span class='st'>"CG"</span>, <span class='st'>"NM"</span><span class='op'>)</span>,
  SameModelMEANSD <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>na.action</span>,
  savemodelframe <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Force <span class='op'>=</span> <span class='cn'>FALSE</span>,
  robust <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formulaMEAN</th>
      <td><p>an object of class <a href='https://rdrr.io/r/stats/formula.html'>formula</a>:
a symbolic description of the model used to explain the
mean of the latent variable. The response variable
should be a numeric vector or factor variable
such that the numerical assignments for the
levels of the factor have ordinal meaning.</p></td>
    </tr>
    <tr>
      <th>formulaSD</th>
      <td><p>either <code>NULL</code> (homoskedastic model) or an object
of class <a href='https://rdrr.io/r/stats/formula.html'>formula</a>: a symbolic description of
the model used to explain the variance of the latent variable.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the variables in the model.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>either <code>NULL</code> or a numeric vector specifying
start values for each of the estimated parameters,
passed to the maximisation routine.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>an optional vector of &#8216;prior weights&#8217; to be used
    in the fitting process.  Should be <code>NULL</code> or a numeric vector.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>specifies a link function for the model to be
estimated, accepted values are <em>"probit"</em>,
<em>"logit"</em>, <em>"cauchit"</em>, <em>"loglog"</em> and <em>"cloglog"</em></p></td>
    </tr>
    <tr>
      <th>constantMEAN</th>
      <td><p>logical. Should an intercept be
included in the model of the mean of the latent variable?
Can be overwritten and set to <code>FALSE</code> using the
<code>formulaMEAN</code> argument by writing <code>0 +</code>
as the first element of the equation.</p></td>
    </tr>
    <tr>
      <th>constantSD</th>
      <td><p>logical. Should an intercept be included
in the model of the variance of the latent variable?
Can be overwritten and set to <code>FALSE</code> using the <code>formulaSD</code>
argument by writing <code>0 +</code> as the first element of the equation.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p><code>NULL</code> or numeric vector. Used to prespecify
elements of the parameter vector for the equation of the mean
of the latent variable. Vector should be of length one or of
length equal to the number of explanatory
variables in the mean equation.
If of length one the value is presumed to correspond to the
constant if a constant is included or the first element of the
parameter vector. If of length greater than one then <code>NA</code>
should be entered for elements of the vector to be estimated.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p><code>NULL</code> or numeric vector. Used to prespecify
elements of the parameter vector for the equation of
the variance of the latent variable. Vector should be of
length one or of length equal to the number of explanatory
variables in the variance equation.
If of length one the value is presumed to
correspond to the constant if a constant is included
or the first element of the parameter vector. If
of length greater than one then <code>NA</code> should be entered
for elements of the vector to be estimated.</p></td>
    </tr>
    <tr>
      <th>threshparam</th>
      <td><p><code>NULL</code> or numeric vector. Used to prespecify
the threshold parameters of the model. Vector should be
of length equal to the number of outcomes minus one. <code>NA</code> should
be entered for threshold parameters to be estimated by the model.</p></td>
    </tr>
    <tr>
      <th>analhessian</th>
      <td><p>logical. Indicates whether the analytic
Hessian should be calculated and used, default is
<code>TRUE</code>, if set to <code>FALSE</code> a finite-difference
approximation of the Hessian is used.</p></td>
    </tr>
    <tr>
      <th>sdmodel</th>
      <td><p>object of mode <em>“expression”</em>. The expression
defines the function that transforms the linear model
for the standard deviation into the standard deviation.
The expression should be written as a function of variable <code>z</code>.
The default value is <code><a href='https://rdrr.io/r/base/expression.html'>expression(exp(z))</a></code>.</p></td>
    </tr>
    <tr>
      <th>optmeth</th>
      <td><p>specifies a method for the maximisation of the likelihood
passed to <code><a href='https://rdrr.io/pkg/maxLik/man/maxLik.html'>maxLik::maxLik()</a></code>. Default to <em>NR</em> (Newton-Raphson)</p></td>
    </tr>
    <tr>
      <th>SameModelMEANSD</th>
      <td><p>logical. Indicates whether the matrix used to
model the mean of the latent variable is identical to that used
to model the variance. If <code>formulaSD=NULL</code> and <code>SameModelMEANSD=TRUE</code> a
model with heteroskedasticity is estimated. If
<code>SameModelMEANSD=FALSE</code> and <code>formulaSD==formulaMEAN</code>
value is overridden. Used to reduce memory requirements when models are identical.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function which indicates what should happen
    when the data contain <code>NA</code>s.  The default is set by
    the <code>na.action</code> setting of <code><a href='https://rdrr.io/r/base/options.html'>options</a></code>, and is
    <code><a href='https://rdrr.io/r/stats/na.fail.html'>na.fail</a></code> if that is unset.  The &#8216;factory-fresh&#8217;
    default is <code><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></code>.  Another possible value is
    <code>NULL</code>, no action.  Value <code><a href='https://rdrr.io/r/stats/na.fail.html'>na.exclude</a></code> can be useful.</p></td>
    </tr>
    <tr>
      <th>savemodelframe</th>
      <td><p>logical. Indicates whether the
model frame(s) should be saved for future use.
Default is <code>FALSE</code>. Should be set to <code>TRUE</code> if
intending to estimate Average Marginal Effects.</p></td>
    </tr>
    <tr>
      <th>Force</th>
      <td><p>logical. If set to <code>FALSE</code> (the default),
the function stops if the response
variable has more than twenty categories.
Should be changed to <code>TRUE</code> if a model with
more than twenty categories is desired.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>logical. If set to <code>TRUE</code> the outer product or
BHHH estimate of the meat in the sandwich of the
variance-covariance matrix is calculated. If calculated
standard errors will be calculated using the sandwich estimator
by default when calling <code>summary</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "<code>oglmx</code>" with the following components:</p><dl>
<dt>loglikelihood</dt><dd><p>log-likelihood for the estimated model.
Includes as attributes the log-likelihood for the constant
only model and the number of observations.</p></dd>
<dt>link</dt><dd><p>link function used in the estimated model.</p></dd>
<dt>no.iterations</dt><dd><p>number of iterations of maximisation algorithm.</p></dd>
<dt>coefficients</dt><dd><p>named vector of estimated parameters.</p></dd>
<dt>returnCode</dt><dd><p>code returned by
the <code>maxLik</code> optimisation routine</p></dd>
<dt>call</dt><dd><p>the call used to generate the results.</p></dd>
<dt>gradient</dt><dd><p>numeric vector, the value of the
gradient of the log-likelihood function at the obtained
parameter vector. Should be approximately equal to zero.</p></dd>
<dt>terms</dt><dd><p>two element list. Each element is an object of
type <code>terms</code> related to the mean and standard
deviation equation respectively.</p></dd>
<dt>formula</dt><dd><p>two element list. Each element is an
object of type <code><a href='https://rdrr.io/r/stats/formula.html'>stats::formula()</a></code> related to
the mean and standard deviation
equation respectively.</p></dd>
<dt>NoVarModData</dt><dd><p>dataframe. Contains data required to
estimate the no information model used in
calculation of McFadden's R-squared measure.</p></dd>
<dt>hessian</dt><dd><p>hessian matrix of the log-likelihood
function evaluated at the obtained parameter vector.</p></dd>
<dt>BHHHhessian</dt><dd><p>Either <code>NULL</code> if no weights were
included and <code>robust = FALSE</code>, or the BHHH estimate.</p></dd>
<dt>Hetero</dt><dd><p>logical. If <code>TRUE</code> indicates that the
estimated model includes a model for the variance
of the error term, i.e. heteroskedasticity.</p></dd>
<dt>NOutcomes</dt><dd><p>the number of distinct outcomes
in the response variable.</p></dd>
<dt>Outcomes</dt><dd><p>numeric vector of length equal to <code>NOutcomes</code>.
Lists the values of the different outcomes.</p></dd>
<dt>BothEq</dt><dd><p>data.frame with either two or three
columns. Lists the names of variables that are in both
the mean and variance equations and their locations
within their respective model frames. Information is required in
the call of <code>margins.oglmx</code> to obtain correct marginal effects.</p></dd>
<dt>allparams</dt><dd><p>a list containing three numeric vectors,
the vectors contain the parameters from the mean equation,
the variance equation and the threshold parameters respectively.
Includes the prespecified and estimated parameters together.</p></dd>
<dt>varMeans</dt><dd><p>a list containing two numeric vectors. The vectors
list the mean values of the variables in the mean and variance
equation respectively. Stored for use in a call of
<code>margins.oglmx</code> to obtain marginal effects at means.</p></dd>
<dt>varBinary</dt><dd><p>a list containing two numeric vectors. The vectors
indicate whether the variables in the mean and variance
equations are binary indicators. Stored for use in a call
of <code>margins.oglmx</code> to obtain marginal effects at means.</p></dd>
<dt>Est.Parameters</dt><dd><p>list containing three logical vectors.
Indicates which parameters in the parameter vectors were estimated.</p></dd>
<dt>modelframes</dt><dd><p>If <code>savemodelframe</code> set to <code>FALSE</code>
then returns <code>NULL</code>, otherwise returns a list with two
elements, the model frames for the mean and variance equations.</p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># create random sample, three variables, two binary.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>242</span><span class='op'>)</span>
<span class='va'>n</span><span class='op'>&lt;-</span><span class='fl'>250</span>
<span class='va'>x1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='va'>n</span>,replace<span class='op'>=</span><span class='cn'>TRUE</span>,prob<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.75</span>,<span class='fl'>0.25</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>x2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"numeric"</span>,<span class='va'>n</span><span class='op'>)</span>
<span class='va'>x2</span><span class='op'>[</span><span class='va'>x1</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='va'>n</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span>,replace<span class='op'>=</span><span class='cn'>TRUE</span>,prob<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>/</span><span class='fl'>3</span>,<span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>z</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>,<span class='fl'>0.5</span><span class='op'>)</span>
<span class='co'># create latent outcome variable</span>
<span class='va'>latenty</span><span class='op'>&lt;-</span><span class='fl'>0.5</span><span class='op'>+</span><span class='fl'>1.5</span><span class='op'>*</span><span class='va'>x1</span><span class='op'>-</span><span class='fl'>0.5</span><span class='op'>*</span><span class='va'>x2</span><span class='op'>+</span><span class='fl'>0.5</span><span class='op'>*</span><span class='va'>z</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>n</span>,sd<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>*</span><span class='va'>x1</span><span class='op'>-</span><span class='fl'>0.5</span><span class='op'>*</span><span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># observed y has four possible values: -1,0,1,2</span>
<span class='co'># threshold values are: -0.5, 0.5, 1.5.</span>
<span class='va'>y</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span><span class='st'>"numeric"</span>,<span class='va'>n</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>latenty</span><span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>0.5</span><span class='op'>]</span><span class='op'>&lt;-</span> <span class='op'>-</span><span class='fl'>1</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>latenty</span><span class='op'>&gt;=</span> <span class='op'>-</span><span class='fl'>0.5</span> <span class='op'>&amp;</span> <span class='va'>latenty</span><span class='op'>&lt;</span><span class='fl'>0.5</span><span class='op'>]</span><span class='op'>&lt;-</span> <span class='fl'>0</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>latenty</span><span class='op'>&gt;=</span> <span class='fl'>0.5</span> <span class='op'>&amp;</span> <span class='va'>latenty</span><span class='op'>&lt;</span><span class='fl'>1.5</span><span class='op'>]</span><span class='op'>&lt;-</span> <span class='fl'>1</span>
<span class='va'>y</span><span class='op'>[</span><span class='va'>latenty</span><span class='op'>&gt;=</span> <span class='fl'>1.5</span><span class='op'>]</span><span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>dataset</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>y</span>,<span class='va'>x1</span>,<span class='va'>x2</span><span class='op'>)</span>
<span class='co'># estimate standard ordered probit</span>
<span class='va'>results.oprob</span><span class='op'>&lt;-</span><span class='fu'>oglmx</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span> <span class='op'>+</span> <span class='va'>z</span>, data<span class='op'>=</span><span class='va'>dataset</span>,link<span class='op'>=</span><span class='st'>"probit"</span>,constantMEAN<span class='op'>=</span><span class='cn'>FALSE</span>,
                     constantSD<span class='op'>=</span><span class='cn'>FALSE</span>,delta<span class='op'>=</span><span class='fl'>0</span>,threshparam<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>results.oprob</span><span class='op'>)</span> <span class='co'># extract estimated coefficients</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>results.oprob</span><span class='op'>)</span>
<span class='co'># calculate marginal effects at means</span>
<span class='fu'>margins.oglmx</span><span class='op'>(</span><span class='va'>results.oprob</span><span class='op'>)</span>
<span class='co'># estimate ordered probit with heteroskedasticity</span>
<span class='va'>results.oprobhet</span><span class='op'>&lt;-</span><span class='fu'>oglmx</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span> <span class='op'>+</span> <span class='va'>z</span>, <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, data<span class='op'>=</span><span class='va'>dataset</span>, link<span class='op'>=</span><span class='st'>"probit"</span>,
                        constantMEAN<span class='op'>=</span><span class='cn'>FALSE</span>, constantSD<span class='op'>=</span><span class='cn'>FALSE</span>,threshparam<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>results.oprobhet</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'>"lmtest"</span><span class='op'>)</span>
<span class='co'># likelihood ratio test to compare model with and without heteroskedasticity.</span>
<span class='fu'><a href='https://rdrr.io/pkg/lmtest/man/lrtest.html'>lrtest</a></span><span class='op'>(</span><span class='va'>results.oprob</span>,<span class='va'>results.oprobhet</span><span class='op'>)</span>
<span class='co'># calculate marginal effects at means.</span>
<span class='fu'>margins.oglmx</span><span class='op'>(</span><span class='va'>results.oprobhet</span><span class='op'>)</span>
<span class='co'># scale of parameter values is meaningless. Suppose instead two of the</span>
<span class='co'># three threshold values were known, then can include constants in the</span>
<span class='co'># mean and standard deviation equation and the scale is meaningful.</span>
<span class='va'>results.oprobhet1</span><span class='op'>&lt;-</span><span class='fu'>oglmx</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span> <span class='op'>+</span> <span class='va'>z</span>, <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, data<span class='op'>=</span><span class='va'>dataset</span>, link<span class='op'>=</span><span class='st'>"probit"</span>,
                         constantMEAN<span class='op'>=</span><span class='cn'>TRUE</span>, constantSD<span class='op'>=</span><span class='cn'>TRUE</span>,threshparam<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>,<span class='fl'>0.5</span>,<span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>results.oprobhet1</span><span class='op'>)</span>
<span class='fu'>margins.oglmx</span><span class='op'>(</span><span class='va'>results.oprobhet1</span><span class='op'>)</span>
<span class='co'># marginal effects are identical to results.oprobithet, but using the true thresholds</span>
<span class='co'># means the estimated parameters are on the same scale as underlying data.</span>
<span class='co'># can choose any two of the threshold values and get broadly the same result.</span>
<span class='va'>results.oprobhet2</span><span class='op'>&lt;-</span><span class='fu'>oglmx</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span> <span class='op'>+</span> <span class='va'>z</span>, <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>x2</span>, data<span class='op'>=</span><span class='va'>dataset</span>, link<span class='op'>=</span><span class='st'>"probit"</span>,
                         constantMEAN<span class='op'>=</span><span class='cn'>TRUE</span>, constantSD<span class='op'>=</span><span class='cn'>TRUE</span>,threshparam<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>0.5</span>,<span class='cn'>NA</span>,<span class='fl'>1.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>results.oprobhet2</span><span class='op'>)</span>
<span class='fu'>margins.oglmx</span><span class='op'>(</span><span class='va'>results.oprobhet2</span><span class='op'>)</span>
<span class='co'># marginal effects are again identical. Parameter estimates do change.</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lino Galiana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


